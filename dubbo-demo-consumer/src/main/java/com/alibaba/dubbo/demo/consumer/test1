@Slf4j
public class AccessLogInterceptor extends HandlerInterceptorAdapter {
    @Override
    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler)
            throws Exception {
        //获取请求参数和请求地址
        String uri = request.getRequestURI();
        String params = request.getParameterMap().entrySet().stream()
                .map(e -> Arrays.stream(e.getValue()).map(v -> e.getKey() + "=" + v)
                        .reduce((v1, v2) -> v1 + "&" + v2).orElse("")
                )
                .reduce((p1, p2) -> p1 + "&" + p2)
                .orElse("");
        String method = request.getMethod();

        //设置trace_id
        putLogUserNo();

        return true;
    }

    @Override
    public void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler,
                           @Nullable ModelAndView modelAndView) throws Exception {
        log.info("in postHandle");
    }

    @Override
    public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler,
                                @Nullable Exception ex) throws Exception {
        log.info("in afterCompletion.");
        clearLocalData();
    }
}
